---
# yaml-language-server: $schema=https://json.schemastore.org/kustomization
apiVersion: kustomize.config.k8s.io/v1alpha1
kind: Component
resources:
  - ./externalsecret.yaml
  - ./repository-pvc.yaml
  - ./pvc.yaml
  - ./replicationdestination.yaml
  - ./replicationsource.yaml

configMapGenerator:
  - name: volsync-truenas-defaults
    literals:
      - VOLSYNC_REPOSITORY_BASE=/repository
      - VOLSYNC_REPOSITORY_NAMESPACE=backups
      - VOLSYNC_CACHE_SNAPSHOTCLASS=truenas-iscsi
      - VOLSYNC_REPOSITORY_QUOTA=500Gi

transformers:
  - |-
    apiVersion: builtin
    kind: PrefixSuffixTransformer
    metadata:
      name: volsync-prefix
    prefix: "volsync-"
    fieldSpecs:
      - path: metadata/name
        kind: ConfigMap
