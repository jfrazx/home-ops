---
apiVersion: psmdb.percona.com/v1
kind: PerconaServerMongoDB
metadata:
  name: unifi-mongodb
  namespace: network
  labels:
    backup/database: "true"
    kustomize.toolkit.fluxcd.io/name: unifi-mongodb
    kustomize.toolkit.fluxcd.io/namespace: flux-system
  annotations:
    reloader.stakater.com/auto: "true"
spec:
  image: percona/percona-server-mongodb:7.0.14-8

  replsets:
  - name: rs0
    size: 3

    resources:
      requests:
        cpu: 100m
        memory: 256Mi
      limits:
        cpu: 500m
        memory: 512Mi

    volumeSpec:
      persistentVolumeClaim:
        resources:
          requests:
            storage: 10Gi
        storageClassName: ceph-block

    expose:
      enabled: true
      exposeType: ClusterIP

  secrets:
    users: unifi-mongodb-credentials
