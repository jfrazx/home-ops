---
# yaml-language-server: $schema=https://kubernetes-schemas.pages.dev/velero.io/schedule_v1.json
apiVersion: velero.io/v1
kind: Schedule
metadata:
  name: daily-apps
  namespace: velero
spec:
  schedule: "0 2 * * *"  # 2 AM daily - before database backups
  template:
    storageLocation: minio
    volumeSnapshotLocations:
      - truenas-nfs-snapshots
      - ceph-csi
    ttl: 168h0m0s  # 7 days

    excludedNamespaces:
      - velero
      - database
      - security

    excludedResources:
      - events
      - events.events.k8s.io
      - replicasets
      - pods

    snapshotVolumes: true
    defaultVolumesToFsBackup: false

    metadata:
      labels:
        velero.io/backup-type: "applications"
        velero.io/schedule-name: "daily-apps"
